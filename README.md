# Handmade KMP Skeleton (S0/S1)

**Цель:** каркас под KMP-ядро + Android-приложение. Внутри — пустые интерфейсы и data-классы
для этапов **S0 (модель/архитектура)** и **S1 (I/O заглушки)**.

## Ключевые моменты

- **Quality-first Auto**: Auto не использует жёсткие дефолты, а подбирает параметры по метрикам качества (Q).
- Размер сетки в Auto — **минимально достаточный**, может подниматься до **480–600** и выше.
- Количество цветов **K** — минимально возможное без просадки Q; для дискретной графики K == реальному числу цветов (после нормализации).
- Дизеринг включаем только если улучшает Q и не вредит краям/чистоте схемы.

## Модули

- `:core:domain` — общие data-контракты, перечисления, интерфейсы оценок качества.
- `:core:decision` — интерфейсы Gate/DecisionEngine, заглушка реализаций.
- `:core:io` — expect/actual I/O для картинок (пока Android-only actual с TODO).
- `:app:android` — минимальная Android-оболочка.

Откройте проект в Android Studio как Gradle-проект. При необходимости обновите версии плагинов.

## S1 — I/O и цвет (Android)

Первая итерация I/O реализована в модуле `:core:io`:

- Общий API на `ImageSource`, `loadImage`, превью и конвертацию в sRGB через Compose `ImageBitmap`.
- Android actual поддерживает EXIF-ориентацию, чтение JPEG/PNG, конвертацию цветового профиля и ленивый `ImageRef`.
- Превью ограничивается по длинной стороне (по умолчанию 1024 px) и всегда возвращается в sRGB.
- Заглушки для будущих desktop/iOS actual расположены в `core/io/src/desktopMain` и `core/io/src/iosMain`.

### Локальный запуск

```bash
./gradlew :core:io:assemble :core:io:testDebugUnitTest
```
